# vacancytest

Собирается приложение с помощью make (`make build`) или в Docker контейнере (`docker build .`)

Настройки приложения можно задать через флаги, переменные окружения или через файл конфигурации. Необходимо указать путь к миграциям и настройки подключения к БД.

Файл конфигурации стандартно должен находится в папке с приложением и называться `config.yaml`.

## Методы

Во всех запросах, кроме запроса на регистрации необходимо передавать логин и пароль использую Basic Auth.

### Работа с пользователями

**GET /users**  
Доступ: editors  
Получение списка пользователей.

Пример ответа:   

```json
  {
    "id": 1,
    "role": "editor",
    "login": "iliad@me.com"
  },
  {
    "id": 2,
    "role": "viewer",
    "login": "x1n@ya.ru"
  }
```

**GET /users/{login}**  
Доступ: editors  
Получение пользователя.
Пример запроса:   

```json
  {
    "id": 1,
    "role": "editor",
    "login": "iliad@me.com"
  }
```

**POST /users/register**  
Доступ: все  
Регистрация нового пользователя. Первый зарегестрированный пользователь будет иметь роль `editor`, а все последующие `viewer`.

Пример запроса:   

```json
{
	"login": "iliad@me.com",
	"password": "1234"
}
```

**POST /users/role**  
Доступ: editors  
Изменение роли другого пользователя. Собственную роль изменить нельзя.

Пример запроса:   

```json
{
	"login": "iliad@icloud.com",
	"role": "editor"
}
```

### Работа с Вакансиями
**GET /vacancies**  
Доступ: viewers,editors  
Получения списка доступных вакансий.

Пример ответа:   

```json
[
  {
    "id": 4,
    "name": "Бухгалтер",
    "salary": 1200,
    "experience": "5 лет",
    "city": "Москва"
  },
  {
    "id": 3,
    "name": "Дворник",
    "salary": 1000,
    "experience": "3 года",
    "city": "Омск"
  },
    {
    "id": 1,
    "name": "Программист",
    "salary": 2000,
    "experience": "1 год",
    "city": "Москва"
  }
]
```

**GET /vacancies/{id}**  
Доступ: viewers,editors  
Получения конкретной вакансии.

Пример ответа:  

```json
{
  	"id": 4,
  	"name": "Бухгалтер",
  	"salary": 1200,
  	"experience": "5 лет",
  	"city": "Москва"
}
```

**POST /vacancies**  
Доступ: editors  
Добавление вакансии.

Пример запроса:   

```json
{
  "name": "Грузчик",
  "salary": 1000,
  "experience": "10 лет",
  "city": "Москва"
}
```

**DELETE /vacancies/{id}**  
Доступ: editors  
Удаление вакансии.


## Файл конфигурации
Пример файла конфигурации:

```yaml
port: "8080" #Порт приложения
debug: true #Дебаг режим
textlog: true #Лог в текстовом формате
migrations: "migrations" #Путь к папке с миграциями
db_pg_addr: "localhost:5432" #Адрес БД
db_pg_dbname: "test" #Название БД
db_pg_login: "postgres" #Логин в БД
db_pg_password: "1234" #Пароль в БД
db_pg_nossl: true #Не использовать SSL
```




